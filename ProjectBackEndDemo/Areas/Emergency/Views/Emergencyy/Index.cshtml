@using Microsoft.AspNetCore.Identity
@using ProjectBackEndDemo.Areas.Identity.Models

@inject UserManager<AppUser> usermanager
@inject SignInManager<AppUser> signinmanager
@inject ProjectBackEndDemo.BL.Helpers.ISelectHelper slct
@{
    ViewBag.Title = "Emergencies";
    Layout = "~/Views/Layouts/MainLayout.cshtml";
    var anilist = new SelectList(slct.GetAnimals(), "Name", "Name");

}
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers
<script src="~/jquery/jquery.min.js"></script>



<br />
<br />
<br />
<br />

<div class="container">


    @if (signinmanager.IsSignedIn(User))
    {
        var x = User.Identity.Name;

        var result = await usermanager.FindByNameAsync(x);
        foreach (var item in await usermanager.GetRolesAsync(result))
        {
            if (item == "Admin" || item == "Vet")
            {
                <a asp-area="Emergency" asp-controller="Emergencyy" asp-action="CreateEmergency" class="btn btn-primary"> Create Emergency </a>

            }
        }


    }



    <br />
    <br />
    <br />
    <br />

    <select id="selectPet" asp-items="@anilist" class="custom-select">
        <option value="">Select Pet</option>
    </select>




    <div>Medical emergencies in pets, by definition, are sudden, unplanned events. It's hard to stay calm when your pet is facing a medical emergency, but being prepared will make it easier. So, get the phone number of the nearest veterinary clinic, and the nearest veterinary hospital that has an emergency department</div>
    <div id="view">

    </div>







    @*COntainer*@
</div>

<script>
    $(function () {

        $("#selectPet").change(function () {

            var x = $("#selectPet").val();

            $.ajax({
                type: "post",
                url: "/Emergency/Emergencyy/FilterData",
                data: { name: x },
                success: function (res) {
                    $("#view").empty();


                    $.each(res, function (i, e) {
                        $("#view").append(

                            "<h2>" + e.Name + " </h2 ><div>" + e.Description + " </div><div class='text-primary'>" + e.HowToDeal + " </div>"


                        )
                    })


                }



            })

        })
    })
</script>





